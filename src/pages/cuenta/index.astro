---
import ProfilePage from '@/components/auth/ProfilePage.astro';
import MainLayout from '@/layouts/MainLayout.astro';

// Verificar sesi√≥n con nuestro sistema
const userSession = Astro.cookies.get('user-session');
let user = null;

if (!userSession) {
  return Astro.redirect('/login');
}

try {
  user = JSON.parse(userSession.value);
} catch (e) {
  return Astro.redirect('/login');
}

// Si es admin, redirigir al dashboard
if (user.role === 'admin') {
  return Astro.redirect('/dashboard');
}
---

<MainLayout title='Mi Cuenta - Premiarte'>
  <ProfilePage user={user} />
</MainLayout>

